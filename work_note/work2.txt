2015-08-24 12:59

1. 品牌和分类 4.0. 需要普通分类支持 banner (需求改动).
2. H5 品牌周的的需求，目前还差后台，未完成，接口基本完成。

3. 给风控提供的接口。 上新时需要进行关键词过滤，还未完成。有可能影响上新过程的执行效率。降低用户体验。
4. IM 推送程序改造。for android only.

2015-08-24 12:58

for higo_risk.
需要绑定host. IP 是 
s.higo.meilishuo.com  10.7.0.21
数据返回格式 是 json.
1.  curl s.higo.meilishuo.com/goods/OnSale?goods_id=174499160783043984      OnSale 支持批量查询，多个id以逗号分隔
2.  curl s.higo.meilishuo.com/goods/OffSale?goods_id=174499160783043984     OffSale 支持批量查询，多个id以逗号分格 
3.  curl s.higo.meilishuo.com/goods/SearchGoods?keyword=xijinping           


152318569781304957, 152320949361226911, 155324721892206968, 168710928739839999, 172418871634476900, 174254282908734998 


2015-08-25 12:20
mysql 
rename table MyClass to YouClass;
例如，在表MyClass名字更改为YouClass:
mysql> rename table MyClass to YouClass;
当你执行 RENAME 时，你不能有任何锁定的表或活动的事务。你同样也必须有对原初表的 ALTER 和 DROP 权限，以及对新表的 CREATE 和 INSERT 权限。
如果在多表更名中，MySQL 遭遇到任何错误，它将对所有被更名的表进行倒退更名，将每件事物退回到最初状态。

系统类目表。

t_pandora_category_floor     分类楼层
t_pandora_category_top       一级分类表
t_pandora_category_position  类目展位表
t_pandora_brand_storey       品牌楼层表
t_pandora_brand_top
t_pandora_brandtop_booth


系统中新添加的表。
category                                 t_pandora_main_category                      
category_property_extend_relation        t_pandora_category_property_extend_relation  类目_扩展属性
category_property_relation               t_pandora_category_property_relation         类目_属性 对应关系
category_property_value_relation         t_pandora_category_property_value_relation   类目_属性值对应关系

property                                 t_pandora_property                     属性表
property_value                           t_pandora_property_value               属性值表    
property_value_relation                  t_pandora_property_value_relation      属性表 和 属性值的对应关系
property_extend                          t_pandora_property_extend              扩展属性

扩展属性和 属性的关系，扩展属性必须是在有属性之后才会有的。

2015-08-26 10:30
t_pandora_home_banner;

banenr 有4中类型。 1 2 3 4:是一个链接。 

t_pandora_brand_top  这个里面的图片都是用 banner 的。banner 的时间属性完全失效。这里最可能有用的一个就是name属性。

2015-08-27 11:57

1. 商家端的需求。        done
2. 商品上新需要检查风控.  done
3. IM 消息推送的改造。
4. H5运营后台的完善。  doing
5. 数据脚本的准备。

日常
6. 对接运营对H5的需求。


2015-08-29 02:47

Mysql export csv

alter table t_pandora_goods add column n_category_id bigint(20) not null default 0 comment '主站叶子类目id';
这个可以将数据导出到 excel 中。 建议在本地的 mysql server 上运行。 但是如何将 excel 中的数据导入到 mysql 中呢。
select * from export_goods43 into outfile '/code/goods_data/export_goods43.csv' fields terminated by ',' enclosed by '"' lines terminated by '\r\n';
对于 MySQL中 将bigint 转换成科学计数法的做法，需要通过alter 字段的类型来解决。必须将 bigint 改变成varchar 或者char 的字符串类型才可以。
alter table export_goods11 change column goods_id goods_id varchar(32) not null default '' comment '';

2015-08-29 12:06
需要上线的表。



CREATE TABLE `t_pandora_brand_storey` (
  `storey_id` int(11) NOT NULL AUTO_INCREMENT COMMENT '楼层编号',
  `storey_parent` int(11) NOT NULL DEFAULT '0' COMMENT '父级编号',
  `storey_level` tinyint(4) NOT NULL DEFAULT '1' COMMENT '楼层层级:1.大楼层；2.小楼层；',
  `storey_children` varchar(255) NOT NULL DEFAULT '' COMMENT '子集编号',
  `storey_name` varchar(128) NOT NULL DEFAULT '' COMMENT '楼层名称',
  `storey_desc` varchar(255) NOT NULL DEFAULT '' COMMENT '楼层描述',
  `storey_image` bigint(20) NOT NULL DEFAULT '0' COMMENT '楼层图片',
  `storey_sort` tinyint(4) NOT NULL DEFAULT '1' COMMENT '楼层排序',
  `storey_status` tinyint(4) NOT NULL DEFAULT '1' COMMENT '楼层状态:1.正常；2.生效；3.删除；',
  `storey_creater` bigint(20) NOT NULL DEFAULT '0' COMMENT '创建人编号',
  `storey_editor` bigint(20) unsigned NOT NULL DEFAULT '0' COMMENT '修改人编号',
  `storey_ctime` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `storey_mtime` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '修改时间',
  `brand_ids` varchar(64) NOT NULL DEFAULT '' COMMENT '楼层品牌id集合',
  `brand_num` tinyint(4) NOT NULL DEFAULT '0' COMMENT '品牌数量',
  `storey_type` tinyint(4) NOT NULL DEFAULT '0' COMMENT '品牌类型: 1.无图；2.左上；',
  PRIMARY KEY (`storey_id`),
  KEY `storey_parent` (`storey_parent`),
  KEY `storey_name` (`storey_name`),
  KEY `storey_status` (`storey_status`)
) ENGINE=InnoDB AUTO_INCREMENT=33 DEFAULT CHARSET=utf8 COMMENT='品牌楼层表';


CREATE TABLE `t_pandora_brand_top` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(64) NOT NULL DEFAULT '' COMMENT '品牌名称',
  `img_id` bigint(20) NOT NULL COMMENT '品牌图片',
  `top_user` varchar(20) NOT NULL DEFAULT '' COMMENT '创建人',
  `top_type` int(11) NOT NULL COMMENT '类型',
  `top_ctime` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `top_mtime` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
  `top_value` bigint(20) NOT NULL DEFAULT '0' COMMENT 'brand_id or banner_id',
  `is_display` smallint(2) NOT NULL DEFAULT '1' COMMENT '是否展示 1 展示 2不展示',
  `status` tinyint(2) NOT NULL DEFAULT '1' COMMENT '0: 删除  1: 未删除',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=21 DEFAULT CHARSET=utf8 COMMENT='品牌详情表';

CREATE TABLE `t_pandora_brandtop_booth` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `top_ids` varchar(20) NOT NULL DEFAULT '' COMMENT '品牌展位的品牌id',
  `sq_number` int(11) NOT NULL DEFAULT '1' COMMENT '展区里的排序',
  `status` tinyint(2) NOT NULL DEFAULT '1' COMMENT '0:删除 1:有效',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=50 DEFAULT CHARSET=utf8 COMMENT='品牌头部列表';



CREATE TABLE `t_pandora_category_top` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'id',
  `cid` int(11) NOT NULL DEFAULT '0' COMMENT '类目id',
  `name` varchar(64) NOT NULL DEFAULT '' COMMENT '名称',
  `img_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '图片',
  `comments` varchar(255) NOT NULL DEFAULT '' COMMENT '备注',
  `ctime` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',
  `mtime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `status` int(4) NOT NULL DEFAULT '1' COMMENT '状态0，删除；1，正常；',
  `sort` int(10) NOT NULL DEFAULT '1' COMMENT '排序',
  `show_type` tinyint(4) NOT NULL DEFAULT '1' COMMENT '展示类型，1为类目，2为banner',
  `banner_id` int(10) NOT NULL DEFAULT '0' COMMENT 'bannerid',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=24 DEFAULT CHARSET=utf8 COMMENT='app首页一级类目';


CREATE TABLE `t_pandora_category_floor` (
  `floor_id` int(10) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) NOT NULL DEFAULT '' COMMENT '名称',
  `comments` varchar(255) NOT NULL DEFAULT '' COMMENT '备注',
  `status` int(4) NOT NULL DEFAULT '1' COMMENT '状态0删除，1正常，2生效',
  `ctime` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
  `mtime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `sort` int(10) NOT NULL DEFAULT '0' COMMENT '排序',
  PRIMARY KEY (`floor_id`)
) ENGINE=InnoDB AUTO_INCREMENT=13 DEFAULT CHARSET=utf8 COMMENT='首页二级分类楼层表';

REATE TABLE `t_pandora_category_position` (
  `position_id` int(10) NOT NULL AUTO_INCREMENT COMMENT '位置id',
  `position_name` varchar(255) NOT NULL DEFAULT '',
  `position_comments` varchar(255) NOT NULL DEFAULT '',
  `cat_id` int(10) NOT NULL DEFAULT '0',
  `img_id` bigint(20) NOT NULL DEFAULT '0',
  `ctime` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
  `mtime` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `sort` int(4) NOT NULL DEFAULT '0',
  `floor_id` int(10) NOT NULL DEFAULT '0' COMMENT '楼层id',
  `position_status` int(4) NOT NULL DEFAULT '1' COMMENT '0删除，1正常，2生效',
  `show_type` int(4) NOT NULL DEFAULT '1' COMMENT '展示类型1.为类目；2，banner',
  `banner_id` int(10) NOT NULL DEFAULT '0' COMMENT 'banner_id',
  PRIMARY KEY (`position_id`)
) ENGINE=InnoDB AUTO_INCREMENT=53 DEFAULT CHARSET=utf8 COMMENT='类目展位表';


