<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>~/work/csdn/xlo_note/src/note.txt.html</title>
<meta name="Generator" content="Vim/7.3">
<meta name="plugin-version" content="vim7.3_v6">
<meta name="syntax" content="none">
<meta name="settings" content="use_css,number_lines">
<style type="text/css">
<!--
pre { font-family: monospace; color: #000000; background-color: #ffffff; }
body { font-family: monospace; color: #000000; background-color: #ffffff; }
.lnr { color: #af5f00; }
-->
</style>
</head>
<body>
<pre>
<span class="lnr">  1 </span>2014-12-01 10:41
<span class="lnr">  2 </span>1: 数据统计。
<span class="lnr">  3 </span>    1：按照店铺进行统计。
<span class="lnr">  4 </span>    2：每天0点进行更新。
<span class="lnr">  5 </span>    3：统计数据中增加IP字段。
<span class="lnr">  6 </span>    4: ip2long() 函数。
<span class="lnr">  7 </span>    5: 需要其他的表来辅助实现。这些吧表怎么构建。
<span class="lnr">  8 </span>    6: 对这几张表的思考。这几个数据都是怎么阳使用的。如何应用这些数据。首先，店铺的数量不会太大，至少在一段时间内
<span class="lnr">  9 </span>        不会增长太多，所以表的规模不用太担心。首先，表中的数据是和日期成正比的。每天都会有一份新的数据产生。考虑到
<span class="lnr"> 10 </span>        查询和,要考虑建索引。这样可以提高查询效率。
<span class="lnr"> 11 </span>    7: 在实际应用场景中，这几张表会怎样增长，数据会怎样变化。
<span class="lnr"> 12 </span>    8: 能否实现上面这些需求。扩展性如何。
<span class="lnr"> 13 </span>select mfrom,  count(*) as count from t_pandora_statistics where maction = 50000 and mfrom in (50001,50002,50003) group by mfrom;
<span class="lnr"> 14 </span>
<span class="lnr"> 15 </span>2014-12-03 11:38
<span class="lnr"> 16 </span>1: 修改商家端注册流程，商家必须上传头像,上传的头像。一个头像id.
<span class="lnr"> 17 </span>html 中table 中的 border属性的设置。如果设置不正确，可能没有边框。下面是正确的设置。
<span class="lnr"> 18 </span>并且 td 的属性会 覆盖 table 的属性。
<span class="lnr"> 19 </span>
<span class="lnr"> 20 </span>2014-12-07 17:05
<span class="lnr"> 21 </span>做子查询的时候，必需要给结果集起别名，否则会有语法错误。
<span class="lnr"> 22 </span>mongo 如果要查询的数据是分为几层的话，应该用这总方式查询。用这种方式来写查询条件。 user.user_id
<span class="lnr"> 23 </span>
<span class="lnr"> 24 </span>sql 中将联表出现的 null 替换成 0， 可以用这个方法。
<span class="lnr"> 25 </span>if(tb2.shop_click is null, 0,tb2.shop_click)
<span class="lnr"> 26 </span>
<span class="lnr"> 27 </span>
<span class="lnr"> 28 </span>如果 group by 来去重要比 distinct 效率要高很多。
<span class="lnr"> 29 </span>子查询要控制
<span class="lnr"> 30 </span>group by 多个字段。
<span class="lnr"> 31 </span>
<span class="lnr"> 32 </span>2014-12-09 15:08
<span class="lnr"> 33 </span>
<span class="lnr"> 34 </span>对 sql 的学习更多了，可以写出更长的 sql 了。
<span class="lnr"> 35 </span>可以 set 变量。sql 中的变量是这样set 的。
<span class="lnr"> 36 </span>set @start = curdate();
<span class="lnr"> 37 </span>可以再一个 set 中定义好几个变量，可以用逗号分开。
<span class="lnr"> 38 </span>另外，yii 中执行的sql 也可以包括好几个句子，但是他们的 读写必须是一直的，就是说，要么是执行 queryall ， 要么是执行 execute。
<span class="lnr"> 39 </span>当然query 是从库， execute 是主库，表示写数据。
<span class="lnr"> 40 </span>
<span class="lnr"> 41 </span>mysql 中和时间相关的函数用着还是很方便的。date_sub(); date_add(); interval 1 day;
<span class="lnr"> 42 </span>另外那些mysql 的工具也是很好用的，不用一直对着 cmd ，有时候还是没有必要的，毕竟不够方便。要结合起来才可以。
<span class="lnr"> 43 </span>
<span class="lnr"> 44 </span>
<span class="lnr"> 45 </span>另外，存储过程是不是也应该掌握一下。
<span class="lnr"> 46 </span>mysql 定义变量是不一样的。和其他语言的不太一样，这个需要注意一下。
<span class="lnr"> 47 </span>
<span class="lnr"> 48 </span>Yii
<span class="lnr"> 49 </span>的 那个 button 是可以优化的，可以加上 htmlOptions,可以规定宽度，这个标签很是有用。
<span class="lnr"> 50 </span>用法就和下面这个一样。
<span class="lnr"> 51 </span><a href="http://www.hankcs.com/appos/yii-kong-zhi-dan-yuan-ge-di-kuan-du.html">http://www.hankcs.com/appos/yii-kong-zhi-dan-yuan-ge-di-kuan-du.html</a>
<span class="lnr"> 52 </span>我希望能掌握一种记东西的比较好的工具，现在直接写html 比较费劲，可以考虑一下用markdown。
<span class="lnr"> 53 </span>
<span class="lnr"> 54 </span>或者直接写 blog 也是可以的。但是我不太喜欢上网页编辑的这个步骤。
<span class="lnr"> 55 </span>
<span class="lnr"> 56 </span>mysql 可以多表连接查询，也可以 left join 和 right join 。但是要注意表的规模。如果表的规模太大，那么联表的效率就iu不敢恭维了。
<span class="lnr"> 57 </span>
<span class="lnr"> 58 </span>所以说队数据的管理还是很重要的。要保证表不会太大。如果有其中一个表太大了，那么联表的结果都是非常可怕的。
<span class="lnr"> 59 </span>如果表中的数据太多的话，那么就要想办法处理这些数据，不要让数据太大。
<span class="lnr"> 60 </span>
<span class="lnr"> 61 </span>2014-12-10 20:37
<span class="lnr"> 62 </span>
<span class="lnr"> 63 </span>需要新加2个接口。
<span class="lnr"> 64 </span>
<span class="lnr"> 65 </span>shop/get_goods_from_weidian;
<span class="lnr"> 66 </span>得到微店商品列表
<span class="lnr"> 67 </span>shop/transfer_weidian_goods;
<span class="lnr"> 68 </span>将选中的商品从微店同步到higo。
<span class="lnr"> 69 </span>
<span class="lnr"> 70 </span>
<span class="lnr"> 71 </span>
<span class="lnr"> 72 </span>2014-12-12 14:11
<span class="lnr"> 73 </span>
<span class="lnr"> 74 </span>1 举报机制还没有测试。
<span class="lnr"> 75 </span>2 举报对应的后台需要完善
<span class="lnr"> 76 </span>3 对应的推送还需要完善。 群聊的推送。（周一考虑）
<span class="lnr"> 77 </span>4 一键搬家的接口(回调，账户的保护)
<span class="lnr"> 78 </span>
<span class="lnr"> 79 </span>
<span class="lnr"> 80 </span>2014-12-12 14:38
<span class="lnr"> 81 </span>------------------
<span class="lnr"> 82 </span>聊天类。
<span class="lnr"> 83 </span>收到 IM push。 进入聊天列表。（商家版，用户版。） mtype = 1 value = 0;
<span class="lnr"> 84 </span>群聊推送  mtype = 2   value = shop_id  点击消息进入群聊进入消息列
<span class="lnr"> 85 </span>
<span class="lnr"> 86 </span>==================
<span class="lnr"> 87 </span>订单相关 PUSH。
<span class="lnr"> 88 </span>
<span class="lnr"> 89 </span>生成新订单。    订单管理页。（商家版） mtype = 5  value = 0
<span class="lnr"> 90 </span>售罄 PUSH。    进入下架商品列表。（商家版） mtype = 6  value = 0
<span class="lnr"> 91 </span>卖家已发货。    进入订单列表。（用户端） mtype = 7 value = 0
<span class="lnr"> 92 </span>买家已付款。         订单列表 （商家版） mtype = 8  value = 0
<span class="lnr"> 93 </span>买家确认收货。     订单列表 （商家版）  mtype = 9 value = 0
<span class="lnr"> 94 </span>自动确认到货         告诉用户。(商家版)    mtype=10 value = 0;(默认 action)
<span class="lnr"> 95 </span>
<span class="lnr"> 96 </span>商家版  推送 告诉商家发货。 mtype=11 value = 0 点击进入订单列表
<span class="lnr"> 97 </span>==================
<span class="lnr"> 98 </span>
<span class="lnr"> 99 </span>活动的推送
<span class="lnr">100 </span>==================
<span class="lnr">101 </span>Android 和 IOS 用户版。 通过 运营后台发送push消息。
<span class="lnr">102 </span>活动推送。             进入首页。 mtype = 12  value = event_id
<span class="lnr">103 </span>(会自动判断是不是秒杀活动) 如果是秒杀互动，mtype = 13
<span class="lnr">104 </span>
<span class="lnr">105 </span>==================
<span class="lnr">106 </span>后台审核通过。
<span class="lnr">107 </span>==================
<span class="lnr">108 </span>店铺通过审核。 进入添加商品页。  mtype = 15 value = 0
<span class="lnr">109 </span>店铺审核未通过。            mtype = 16  value = 0
<span class="lnr">110 </span>商品审核未通过。            mtype = 17  value = 0
<span class="lnr">111 </span>商品被后台下架。            mtype = 18  value = goods_id 点击跳转到商品详情页 商家端
<span class="lnr">112 </span>==================
<span class="lnr">113 </span>单品分享
<span class="lnr">114 </span>mtype = 20
<span class="lnr">115 </span>==================
<span class="lnr">116 </span>活动分享 URL。
<span class="lnr">117 </span>mtype = 12 value = event_id
<span class="lnr">118 </span>==================
<span class="lnr">119 </span>分享秒杀活动
<span class="lnr">120 </span>mtype = 13  value = event_id;
<span class="lnr">121 </span>
<span class="lnr">122 </span>
<span class="lnr">123 </span>消息举报
<span class="lnr">124 </span>mtype = 30  value=0 消息举报被禁言的推送  行为暂时没有规定
<span class="lnr">125 </span>
<span class="lnr">126 </span>微点搬家回调
<span class="lnr">127 </span>微店搬家登录成功  mtype = 40 value = 0  行为待确定
<span class="lnr">128 </span>微店搬家完成      mtype = 41 value = 0  行为待确定
<span class="lnr">129 </span>==================
<span class="lnr">130 </span>--------------------------------
<span class="lnr">131 </span>php url
<span class="lnr">132 </span>$url = 'testurl';
<span class="lnr">133 </span>$html = file_get_contents($url);
<span class="lnr">134 </span>$content = json_decode($html);
<span class="lnr">135 </span>var_dump($content);
<span class="lnr">136 </span>http_build_query();
<span class="lnr">137 </span>
<span class="lnr">138 </span>
<span class="lnr">139 </span>
<span class="lnr">140 </span>2014-12-15 10:33
<span class="lnr">141 </span>
<span class="lnr">142 </span>如果举报同一个人，那么这个人的禁言时间会被刷新成目前的时间。
<span class="lnr">143 </span>
<span class="lnr">144 </span>perl 形式的正则。
<span class="lnr">145 </span>preg_match($mode,  $str, $matches);
<span class="lnr">146 </span>preg_replace();
<span class="lnr">147 </span>
<span class="lnr">148 </span>现在API的工作基本上差不多了，我需要着手 群聊消息推送的内容。
<span class="lnr">149 </span>
<span class="lnr">150 </span>群聊需要将新消息推送给群里的每一个人。并且在推送之前，都需要看一下这个人是不是设置成免打扰模式的。
<span class="lnr">151 </span>如果是免打扰模式的，那么不给这个人推送消息。
<span class="lnr">152 </span>基本上和群相关的所有数据都是在MONgo 里面的。我需要给python 安装mongo组件，并且学习python的mongo组建。
<span class="lnr">153 </span>学习队mongo的操作。每一段时间执行一次，将所有的新消息，推送给群里的所有人。
<span class="lnr">154 </span>
<span class="lnr">155 </span>是不是部分是不是离线。
<span class="lnr">156 </span>
<span class="lnr">157 </span>应该是只会推送给离线的朋友们，在线的是要跳过的。
<span class="lnr">158 </span>mongo , redis, mysql ;
<span class="lnr">159 </span>I need you.
<span class="lnr">160 </span>
<span class="lnr">161 </span>import pprint
<span class="lnr">162 </span>
<span class="lnr">163 </span>pprint.pprint(yourarray);
<span class="lnr">164 </span>
<span class="lnr">165 </span>easy_install pymongo
<span class="lnr">166 </span>easy_install redis
<span class="lnr">167 </span>
<span class="lnr">168 </span>python mongo 构造查询条件的时候需要这样子。构造字典 需要这样。
<span class="lnr">169 </span>
<span class="lnr">170 </span>condition={}
<span class="lnr">171 </span>condition['seq'] = {}
<span class="lnr">172 </span>condition['seq']['$gt'] = 10
<span class="lnr">173 </span>condition['createAt'] = {}
<span class="lnr">174 </span>condition['createAt']['$gt'] = '1418634210';
<span class="lnr">175 </span>
<span class="lnr">176 </span>不能直接这样子。
<span class="lnr">177 </span>condtion = {'seq':{'$gt':'123123'},'createAt'{'$gt':'21'}}
<span class="lnr">178 </span>
<span class="lnr">179 </span>
<span class="lnr">180 </span>
<span class="lnr">181 </span>
<span class="lnr">182 </span>队面向对象也有了新的认识，还是应该多谢点程序，就算是最简单的 dbo block，尽量写好一点，尽量可以分享出去，能
<span class="lnr">183 </span>够给别人带来方便。
<span class="lnr">184 </span>
<span class="lnr">185 </span>所以写的时候要规范一点，虽然我对python了解也比较少，正式因为这个，在学习写得过程中才会有进步。
<span class="lnr">186 </span>
<span class="lnr">187 </span>算是对 mongo 比较熟悉了，但是我不想把学习的过程详细的写出来。
<span class="lnr">188 </span>如果我回了，我就懒得去动手谢了，我遇到的问题队我来说已经不是问题了。所以我没有必要写了。
<span class="lnr">189 </span>但是这样队别人能带来什么帮助，不是说相和别人共享知识吗，这就是这种共享态度吗？
<span class="lnr">190 </span>
<span class="lnr">191 </span>ret = table.find();
<span class="lnr">192 </span>返回的结果是可以 count 的。ret.count() 可以查看条数。
<span class="lnr">193 </span>
<span class="lnr">194 </span>python mongo 学习了不少。
<span class="lnr">195 </span>可以用 eval 求值来解决 库和表的选择问题。
<span class="lnr">196 </span>但是里面的成员变量要写成 public 的。
<span class="lnr">197 </span>python 的public 和 private 是不一样的，要认真思考一下他们的区别。
<span class="lnr">198 </span>
<span class="lnr">199 </span>还没有搞完，明天继续。
<span class="lnr">200 </span>
<span class="lnr">201 </span>2014-12-16 12:31
<span class="lnr">202 </span>写伪代码还是很清楚的，有时间可以多写一点，我真是本末倒置。
<span class="lnr">203 </span>
<span class="lnr">204 </span>redis 的connectionPool() 是什么意思，这个是怎么使用的。
<span class="lnr">205 </span>有什么好处。
<span class="lnr">206 </span>
<span class="lnr">207 </span>2014-12-17 11:20
<span class="lnr">208 </span>alter table t_pandora_statistics add key uuid_index (uuid);
<span class="lnr">209 </span>
<span class="lnr">210 </span>ajax 我根本就不会，jquery 的ajax，还需要联系下。
<span class="lnr">211 </span>
<span class="lnr">212 </span>2015-01-04 14:08
<span class="lnr">213 </span>
<span class="lnr">214 </span>the error may be in a field that is not displayed?
<span class="lnr">215 </span>try this after $model-&gt;save()
<span class="lnr">216 </span>print_r($model-&gt;getErrors());
<span class="lnr">217 </span>$model-&gt;getErrors(); 可以看出上一个错误是什么。
<span class="lnr">218 </span>or
<span class="lnr">219 </span>in the config/main.php
<span class="lnr">220 </span>enable logs for error and trace
<span class="lnr">221 </span>and see the file runtime/application.log
<span class="lnr">222 </span>
<span class="lnr">223 </span>今天遇到的问题，通过的时候save 老是不能成功，我只看到了save 的return status is false。
<span class="lnr">224 </span>但是我并不知道是什么错误，后面找到了上面的解决方案。看到了原来一个字段是空的，而在model里面
<span class="lnr">225 </span>这个字段是 required 的。所以就保存失败了。
<span class="lnr">226 </span>
<span class="lnr">227 </span>不过正因为这个问题，我队 Yii 的了解也多了一些，还需要继续学习。
<span class="lnr">228 </span>
<span class="lnr">229 </span>刚才遇到的问题是
<span class="lnr">230 </span>CGridView 的问题。想要实现 columns 里面的 指定列的自定义，就是不同类型给不同的颜色。但是也找了
<span class="lnr">231 </span>好久。
<span class="lnr">232 </span>想的是给一个 html 元素。但是刚开始是不会显示的，除非你加上这个选项。 'type'=&gt;'raw';
<span class="lnr">233 </span>
<span class="lnr">234 </span>这个方法并没有解决问题，但是也是有价值的。
<span class="lnr">235 </span>'htmlOptions'=&gt;array('style'=&gt;'Convert::shop_change_status_color($data-&gt;status)')
<span class="lnr">236 </span>
<span class="lnr">237 </span>array(
<span class="lnr">238 </span>    'name'=&gt;'status',
<span class="lnr">239 </span>    'value'=&gt;'Convert::shop_change_status($data-&gt;status)',
<span class="lnr">240 </span>    'htmlOptions'=&gt;array('style'=&gt;'Convert::shop_change_status_color($data-&gt;status)')
<span class="lnr">241 </span>    //'value'=&gt;'Convert::shop_change_status($data-&gt;status)'
<span class="lnr">242 </span>),
<span class="lnr">243 </span><a href="http://stackoverflow.com/questions/8140613/yii-zii-widgets-grid-cgridview-with-type-html-render-failed">http://stackoverflow.com/questions/8140613/yii-zii-widgets-grid-cgridview-with-type-html-render-failed</a>
<span class="lnr">244 </span>
<span class="lnr">245 </span>关于 Yii 应该多了解一下。要学着自己定义。在框架的基础商进行自定义。
<span class="lnr">246 </span>
<span class="lnr">247 </span>2015-01-05 10:59
<span class="lnr">248 </span>
<span class="lnr">249 </span>mysql 数据查询。
<span class="lnr">250 </span>
<span class="lnr">251 </span>
<span class="lnr">252 </span>
<span class="lnr">253 </span>2015-01-05 15:06
<span class="lnr">254 </span>新加表项。
<span class="lnr">255 </span>create table t_pandora_home_banner(
<span class="lnr">256 </span>    banner_id int(11) unsigned auto_increment primary key,
<span class="lnr">257 </span>    banner_status tinyint(4) not null default 1,
<span class="lnr">258 </span>    banner_start timestamp not null default '0000-00-00 00:00:00',
<span class="lnr">259 </span>    banner_end timestamp not null default '0000-00-00 00:00:00'
<span class="lnr">260 </span>)engine = InnoDB, charset = utf8 ,auto_increment = 1, comment '首页banner 主表';
<span class="lnr">261 </span>
<span class="lnr">262 </span>
<span class="lnr">263 </span>
<span class="lnr">264 </span>create table t_pandora_home_banner_item(
<span class="lnr">265 </span>    banner_id int(11) unsigned not null default 0 primary key,
<span class="lnr">266 </span>    position tinyint unsigned not null default 1 comment '排序字段,控制位置',
<span class="lnr">267 </span>    mtype tinyint(4) unsigned not null default 1 comment '1群  2 专题 3 单品',
<span class="lnr">268 </span>    mvalue bigint(20) unsigned not null default 0 comment '对应的类型的 值 群的shop_id event_id 单品 id',
<span class="lnr">269 </span>    banner_item_status tinyint(4) not null default 1,
<span class="lnr">270 </span>    banner_pic bigint(20) unsigned not null default 0
<span class="lnr">271 </span>)engine = InnoDB, charset = utf8, comment '首页banner明细';
<span class="lnr">272 </span>
<span class="lnr">273 </span>
<span class="lnr">274 </span>
<span class="lnr">275 </span>Yii app's application.log is in protected/runtime/application.log; not in main dir's runtime/
<span class="lnr">276 </span>
<span class="lnr">277 </span>给的数据大致是这样，根据里面的type ， 去 分发到不同的接口。
<span class="lnr">278 </span>mtype == 1
<span class="lnr">279 </span>    call  group_chat/get_detail  shop_id = mvalue;
<span class="lnr">280 </span>mtype == 2
<span class="lnr">281 </span>    call  event/get_event_items  event_id = mvalue;
<span class="lnr">282 </span>mtype == 3
<span class="lnr">283 </span>    call  goods/get_detail       goods_id = mvalue;
<span class="lnr">284 </span>
<span class="lnr">285 </span>2015-01-06 14:30
<span class="lnr">286 </span>
<span class="lnr">287 </span>
<span class="lnr">288 </span>unicodedecodeerror: 'ascii' codec can't decode byte 0xef in position 0: ordinal not in range(128)
<span class="lnr">289 </span>import sys
<span class="lnr">290 </span>sys.reload()
<span class="lnr">291 </span>sys.setdefaultencoding(&quot;utf-8&quot;)
<span class="lnr">292 </span>这个可以解决问题。
<span class="lnr">293 </span>
<span class="lnr">294 </span>step 1
<span class="lnr">295 </span>    finished you code.
<span class="lnr">296 </span>step 2
<span class="lnr">297 </span>    刷数据，所有 token status = 1 的account_id 添加 redis 缓存。
<span class="lnr">298 </span>
<span class="lnr">299 </span>2015-01-09 18:28
<span class="lnr">300 </span>div 也有 align 属性，center 就可以。 表示里面的内容在 div 的中间。
<span class="lnr">301 </span>
<span class="lnr">302 </span>&quot;&lt;div align='center'&gt; &lt;a href='index.php?r=homeBanner/admin'&gt; &lt;h3&gt; 返回 &lt;/h3&gt; &lt;/a&gt;&lt;/div&gt;&quot;
<span class="lnr">303 </span>
<span class="lnr">304 </span>2015-01-12 10:50
<span class="lnr">305 </span>jquery radio 选中事件。
<span class="lnr">306 </span>jquery onclick 事件， onchange 事件。我们根据radio 的 name 来选择选中的radio。
<span class="lnr">307 </span>jquery 代码如下
</pre>
</body>
</html>
